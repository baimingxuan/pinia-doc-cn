<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æµ‹è¯• stores | Pinia ä¸­æ–‡æ–‡æ¡£</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="æ–‡æ¡£å†…å®¹è¯¦ç»†ç¿»è¯‘è‡ªå®˜æ–¹è‹±æ–‡æ–‡æ¡£">
    
    <link rel="preload" href="/pinia-doc-cn/assets/css/0.styles.7ca0e035.css" as="style"><link rel="preload" href="/pinia-doc-cn/assets/js/app.26e1221b.js" as="script"><link rel="preload" href="/pinia-doc-cn/assets/js/2.cc001fb0.js" as="script"><link rel="preload" href="/pinia-doc-cn/assets/js/13.bd9f521e.js" as="script"><link rel="prefetch" href="/pinia-doc-cn/assets/js/10.81b62d2b.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/11.d243ede0.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/12.04ac47d5.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/14.b77cfa6e.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/15.ba038539.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/16.46a1f6e6.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/17.59f4af1b.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/18.6ca16828.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/19.f941157e.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/20.b0c620ba.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/21.1ff9a2c6.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/22.e7b1edc1.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/23.6735df5c.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/3.32b655d3.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/4.b7d0708f.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/5.9e2f4ca7.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/6.c7b54f12.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/7.c7f5398c.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/8.ff83f9c5.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/9.eada0501.js">
    <link rel="stylesheet" href="/pinia-doc-cn/assets/css/0.styles.7ca0e035.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/pinia-doc-cn/" class="home-link router-link-active"><!----> <span class="site-name">Pinia ä¸­æ–‡æ–‡æ¡£</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/baimingxuan/pinia-doc-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/baimingxuan/pinia-doc-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/pinia-doc-cn/guide/introduction" class="sidebar-heading clickable"><span>ä»‹ç»</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/pinia-doc-cn/guide/introduction.html" class="sidebar-link">Piniaæ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li><a href="/pinia-doc-cn/guide/getting-started.html" class="sidebar-link">å¿«é€Ÿä¸Šæ‰‹</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/pinia-doc-cn/core/defining-store" class="sidebar-heading clickable"><span>æ ¸å¿ƒæ¦‚å¿µ</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/pinia-doc-cn/core/defining-store.html" class="sidebar-link">å®šä¹‰Store</a></li><li><a href="/pinia-doc-cn/core/state.html" class="sidebar-link">State</a></li><li><a href="/pinia-doc-cn/core/getters.html" class="sidebar-link">Getters</a></li><li><a href="/pinia-doc-cn/core/actions.html" class="sidebar-link">Actions</a></li><li><a href="/pinia-doc-cn/core/plugins.html" class="sidebar-link">Plugins</a></li><li><a href="/pinia-doc-cn/core/outside-component-usage.html" class="sidebar-link">ç»„ä»¶å¤–ä½¿ç”¨Store</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/pinia-doc-cn/ssr/vue-and-vite" class="sidebar-heading clickable"><span>æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/pinia-doc-cn/ssr/vue-and-vite.html" class="sidebar-link">Vueå’ŒVite</a></li><li><a href="/pinia-doc-cn/ssr/nuxt.html" class="sidebar-link">Nuxt</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/pinia-doc-cn/cookbook/migration-vuex" class="sidebar-heading clickable open"><span>æ“ä½œæ‰‹å†Œ</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/pinia-doc-cn/cookbook/migration-vuex.html" class="sidebar-link">ä»Vuexâ‰¤4è¿ç§»</a></li><li><a href="/pinia-doc-cn/cookbook/hot-module-replacement.html" class="sidebar-link">HMR(çƒ­æ¨¡å—æ›´æ–°)</a></li><li><a href="/pinia-doc-cn/cookbook/testing.html" aria-current="page" class="active sidebar-link">Testing(æµ‹è¯•)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pinia-doc-cn/cookbook/testing.html#å•å…ƒæµ‹è¯•-store" class="sidebar-link">å•å…ƒæµ‹è¯• Store</a></li><li class="sidebar-sub-header"><a href="/pinia-doc-cn/cookbook/testing.html#å•å…ƒæµ‹è¯•ç»„ä»¶" class="sidebar-link">å•å…ƒæµ‹è¯•ç»„ä»¶</a></li><li class="sidebar-sub-header"><a href="/pinia-doc-cn/cookbook/testing.html#e2e-æµ‹è¯•" class="sidebar-link">E2E æµ‹è¯•</a></li><li class="sidebar-sub-header"><a href="/pinia-doc-cn/cookbook/testing.html#å•å…ƒæµ‹è¯•ç»„ä»¶-vue-2" class="sidebar-link">å•å…ƒæµ‹è¯•ç»„ä»¶ï¼ˆVue 2ï¼‰</a></li></ul></li><li><a href="/pinia-doc-cn/cookbook/options-api.html" class="sidebar-link">ä¸ä½¿ç”¨setup()çš„ç”¨æ³•</a></li><li><a href="/pinia-doc-cn/cookbook/composing-stores.html" class="sidebar-link">ç»„åˆStores</a></li><li><a href="/pinia-doc-cn/cookbook/migration-v1-v2.html" class="sidebar-link">ä»0.x(v1)è¿ç§»åˆ°v2</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="æµ‹è¯•-stores"><a href="#æµ‹è¯•-stores" class="header-anchor">#</a> æµ‹è¯• stores</h1> <p>ä»è®¾è®¡ä¸Šè®²ï¼Œ<code>stores</code>å°†åœ¨è®¸å¤šåœ°æ–¹è¢«ä½¿ç”¨ï¼Œå¹¶ä¸”ä¼šä½¿æµ‹è¯•å˜å¾—æ¯”åº”è¯¥çš„å›°éš¾å¾—å¤šã€‚å¹¸è¿çš„æ˜¯ï¼Œäº‹å®å¹¶éå¦‚æ­¤ã€‚åœ¨æµ‹è¯•<code>stores</code>æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p> <ul><li><code>Pinia</code>å®ä¾‹ï¼šæ²¡æœ‰å®ƒï¼Œ<code>stores</code>å°±æ— æ³•è¿ä½œ</li> <li><code>Actions</code>ï¼šå¤§å¤šæ•°æ—¶å€™ï¼Œå®ƒä»¬åŒ…å«äº†<code>stores</code>æœ€å¤æ‚çš„é€»è¾‘ã€‚å¦‚æœä»–ä»¬é»˜è®¤è¢«æ¨¡æ‹Ÿä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ</li> <li><code>Plugins</code>ï¼šå¦‚æœæ‚¨ä¾èµ–äºæ’ä»¶ï¼Œæ‚¨ä¹Ÿå¿…é¡»å®‰è£…å®ƒä»¬å¹¶è¿›è¡Œæµ‹è¯•</li></ul> <p>æ ¹æ®æ‚¨æµ‹è¯•çš„å†…å®¹æˆ–æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†è¿™ä¸‰ä¸ªé—®é¢˜ï¼š</p> <ul><li><p>æµ‹è¯• <code>Stores</code></p></li> <li><ul><li><a href="https://baimingxuan.net/pinia-doc-cn/cookbook/testing.html#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95-store" target="_blank" rel="noopener noreferrer">å•å…ƒæµ‹è¯•store<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://baimingxuan.net/pinia-doc-cn/cookbook/testing.html#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%BB%84%E4%BB%B6" target="_blank" rel="noopener noreferrer">å•å…ƒæµ‹è¯•ç»„ä»¶<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://baimingxuan.net/pinia-doc-cn/cookbook/testing.html#e2e-%E6%B5%8B%E8%AF%95" target="_blank" rel="noopener noreferrer">E2Eæµ‹è¯•<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://baimingxuan.net/pinia-doc-cn/cookbook/testing.html#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%BB%84%E4%BB%B6-vue-2" target="_blank" rel="noopener noreferrer">å•å…ƒæµ‹è¯•ç»„ä»¶(Vue 2)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <h2 id="å•å…ƒæµ‹è¯•-store"><a href="#å•å…ƒæµ‹è¯•-store" class="header-anchor">#</a> å•å…ƒæµ‹è¯• Store</h2> <p>è¦å¯¹<code>store</code>è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œæœ€é‡è¦çš„éƒ¨åˆ†æ˜¯åˆ›å»º<code>pinia</code>å®ä¾‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// counterStore.spec.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> setActivePinia<span class="token punctuation">,</span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useCounter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../src/stores/counter'</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Counter Store'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// creates a fresh pinia and make it active so it's automatically picked</span>
    <span class="token comment">// up by any useStore() call without having to pass it to it:</span>
    <span class="token comment">// `useStore(pinia)`</span>
    <span class="token function">setActivePinia</span><span class="token punctuation">(</span><span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'increments'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> counter <span class="token operator">=</span> <span class="token function">useCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    counter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'increments by amount'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> counter <span class="token operator">=</span> <span class="token function">useCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    counter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¦‚æœæ‚¨æœ‰ä½¿ç”¨<code>store</code>æ’ä»¶ï¼Œæœ‰ä¸€ä»¶é‡è¦çš„äº‹æƒ…è¦çŸ¥é“ï¼šåœ¨åº”ç”¨å®‰è£…<code>pinia</code>ä¹‹å‰ï¼Œæ’ä»¶ä¸ä¼šè¢«ä½¿ç”¨ã€‚å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªç©ºåº”ç”¨æˆ–å‡åº”ç”¨æ¥è§£å†³ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> setActivePinia<span class="token punctuation">,</span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> somePlugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../src/stores/plugin'</span>

<span class="token comment">// same code as above...</span>

<span class="token comment">// you don't need to create one app per test</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> pinia <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>somePlugin<span class="token punctuation">)</span>
  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>pinia<span class="token punctuation">)</span>
  <span class="token function">setActivePinia</span><span class="token punctuation">(</span>pinia<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="å•å…ƒæµ‹è¯•ç»„ä»¶"><a href="#å•å…ƒæµ‹è¯•ç»„ä»¶" class="header-anchor">#</a> å•å…ƒæµ‹è¯•ç»„ä»¶</h2> <p>å¯ä»¥é€šè¿‡ <code>createTestingPinia()</code>å®ç°ã€‚æˆ‘è¿˜æ²¡æœ‰ä¸ºå®ƒç¼–å†™åˆé€‚çš„æ–‡æ¡£ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡è‡ªåŠ¨è¡¥å…¨å’Œå‡ºç°åœ¨å·¥å…·æç¤ºä¸­çš„æ–‡æ¡£æ¥ç†è§£å®ƒçš„ç”¨æ³•ã€‚</p> <p>ä»å®‰è£…<code>@pinia/testing</code>å¼€å§‹ï¼š</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> i -D @pinia/testing
</code></pre></div><p>å½“ç»„ä»¶æŒ‚è½½æ—¶ï¼Œè¯·ç¡®ä¿åœ¨æµ‹è¯•ä¸­åˆ›å»ºä¸€ä¸ªæµ‹è¯•<code>pinia</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createTestingPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@pinia/testing'</span>

<span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Counter<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">global</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">createTestingPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useSomeStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// uses the testing pinia!</span>

<span class="token comment">// state can be directly manipulated</span>
store<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'my new name'</span>
<span class="token comment">// can also be done through patch</span>
store<span class="token punctuation">.</span><span class="token function">$patch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'new name'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">'new name'</span><span class="token punctuation">)</span>

<span class="token comment">// actions are stubbed by default but can be configured by</span>
<span class="token comment">// passing an option to `createTestingPinia()`</span>
store<span class="token punctuation">.</span><span class="token function">someAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>someAction<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledTimes</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">expect</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>someAction<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenLastCalledWith</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯<code>Vue 2</code>ï¼Œ <code>@vue/test-utils</code>ä¼šæœ‰äº›è®¸<a href="https://baimingxuan.net/pinia-doc-cn/cookbook/testing.html#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%BB%84%E4%BB%B6-vue-2" target="_blank" rel="noopener noreferrer">ä¸åŒçš„é…ç½®<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <p><a href="https://github.com/vuejs/pinia/blob/v2/packages/testing/src/testing.spec.ts" target="_blank" rel="noopener noreferrer">æ‚¨å¯ä»¥åœ¨æµ‹è¯•åŒ…çš„æµ‹è¯•<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>é‡Œæ‰¾åˆ°æ›´å¤šç¤ºä¾‹ã€‚</p> <h2 id="e2e-æµ‹è¯•"><a href="#e2e-æµ‹è¯•" class="header-anchor">#</a> E2E æµ‹è¯•</h2> <p>å¯¹äº<code>Pinia</code>ï¼Œæ‚¨æ— éœ€ä¸º<code>E2E</code>æµ‹è¯•æ›´æ”¹ä»»ä½•ä¸œè¥¿ï¼Œè¿™æ˜¯<code>E2E</code>æµ‹è¯•æœ€é‡è¦çš„ç‚¹ï¼æ‚¨ä¹Ÿå¯ä»¥æµ‹è¯•<code>HTTP</code>è¯·æ±‚ï¼Œä½†è¿™å·²ç»è¶…å‡ºäº†æœ¬æŒ‡å—çš„èŒƒå›´ğŸ˜„ã€‚</p> <h2 id="å•å…ƒæµ‹è¯•ç»„ä»¶-vue-2"><a href="#å•å…ƒæµ‹è¯•ç»„ä»¶-vue-2" class="header-anchor">#</a> å•å…ƒæµ‹è¯•ç»„ä»¶ï¼ˆVue 2ï¼‰</h2> <p>å½“ä½¿<a href="https://v1.test-utils.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">Vue Test Utils 1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æ—¶ï¼Œåœ¨<code>localVue</code>ä¸Šå®‰è£…<code>Pinia</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> PiniaVuePlugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createLocalVue<span class="token punctuation">,</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createTestingPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@pinia/testing'</span>

<span class="token keyword">const</span> localVue <span class="token operator">=</span> <span class="token function">createLocalVue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
localVue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>PiniaVuePlugin<span class="token punctuation">)</span>

<span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Counter<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  localVue<span class="token punctuation">,</span>
  <span class="token literal-property property">pinia</span><span class="token operator">:</span> <span class="token function">createTestingPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useSomeStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// uses the testing pinia!</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/baimingxuan/pinia-doc-cn/edit/main/docs/cookbook/testing.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°æ—¶é—´:</span> <span class="time">2022/3/3 ä¸‹åˆ11:08:08</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/pinia-doc-cn/cookbook/hot-module-replacement.html" class="prev">
        HMR(çƒ­æ¨¡å—æ›´æ–°)
      </a></span> <span class="next"><a href="/pinia-doc-cn/cookbook/options-api.html">
        ä¸ä½¿ç”¨setup()çš„ç”¨æ³•
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/pinia-doc-cn/assets/js/app.26e1221b.js" defer></script><script src="/pinia-doc-cn/assets/js/2.cc001fb0.js" defer></script><script src="/pinia-doc-cn/assets/js/13.bd9f521e.js" defer></script>
  </body>
</html>
