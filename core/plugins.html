<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Plugins | Pinia ä¸­æ–‡æ–‡æ¡£</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="æ–‡æ¡£å†…å®¹è¯¦ç»†ç¿»è¯‘è‡ªå®˜æ–¹è‹±æ–‡æ–‡æ¡£">
    
    <link rel="preload" href="/pinia-doc-cn/assets/css/0.styles.7ca0e035.css" as="style"><link rel="preload" href="/pinia-doc-cn/assets/js/app.26e1221b.js" as="script"><link rel="preload" href="/pinia-doc-cn/assets/js/2.cc001fb0.js" as="script"><link rel="preload" href="/pinia-doc-cn/assets/js/18.6ca16828.js" as="script"><link rel="prefetch" href="/pinia-doc-cn/assets/js/10.81b62d2b.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/11.d243ede0.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/12.04ac47d5.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/13.bd9f521e.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/14.b77cfa6e.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/15.ba038539.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/16.46a1f6e6.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/17.59f4af1b.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/19.f941157e.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/20.b0c620ba.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/21.1ff9a2c6.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/22.e7b1edc1.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/23.6735df5c.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/3.32b655d3.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/4.b7d0708f.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/5.9e2f4ca7.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/6.c7b54f12.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/7.c7f5398c.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/8.ff83f9c5.js"><link rel="prefetch" href="/pinia-doc-cn/assets/js/9.eada0501.js">
    <link rel="stylesheet" href="/pinia-doc-cn/assets/css/0.styles.7ca0e035.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/pinia-doc-cn/" class="home-link router-link-active"><!----> <span class="site-name">Pinia ä¸­æ–‡æ–‡æ¡£</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/baimingxuan/pinia-doc-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/baimingxuan/pinia-doc-cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/pinia-doc-cn/guide/introduction" class="sidebar-heading clickable"><span>ä»‹ç»</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/pinia-doc-cn/guide/introduction.html" class="sidebar-link">Piniaæ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li><a href="/pinia-doc-cn/guide/getting-started.html" class="sidebar-link">å¿«é€Ÿä¸Šæ‰‹</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/pinia-doc-cn/core/defining-store" class="sidebar-heading clickable open"><span>æ ¸å¿ƒæ¦‚å¿µ</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/pinia-doc-cn/core/defining-store.html" class="sidebar-link">å®šä¹‰Store</a></li><li><a href="/pinia-doc-cn/core/state.html" class="sidebar-link">State</a></li><li><a href="/pinia-doc-cn/core/getters.html" class="sidebar-link">Getters</a></li><li><a href="/pinia-doc-cn/core/actions.html" class="sidebar-link">Actions</a></li><li><a href="/pinia-doc-cn/core/plugins.html" aria-current="page" class="active sidebar-link">Plugins</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pinia-doc-cn/core/plugins.html#ä»‹ç»" class="sidebar-link">ä»‹ç»</a></li><li class="sidebar-sub-header"><a href="/pinia-doc-cn/core/plugins.html#æ‰©å±•-store" class="sidebar-link">æ‰©å±• Store</a></li><li class="sidebar-sub-header"><a href="/pinia-doc-cn/core/plugins.html#æ·»åŠ æ–°çš„å¤–éƒ¨å±æ€§" class="sidebar-link">æ·»åŠ æ–°çš„å¤–éƒ¨å±æ€§</a></li><li class="sidebar-sub-header"><a href="/pinia-doc-cn/core/plugins.html#åœ¨æ’ä»¶å†…éƒ¨è°ƒç”¨-subscribe" class="sidebar-link">åœ¨æ’ä»¶å†…éƒ¨è°ƒç”¨ $subscribe</a></li><li class="sidebar-sub-header"><a href="/pinia-doc-cn/core/plugins.html#æ·»åŠ æ–°é€‰é¡¹" class="sidebar-link">æ·»åŠ æ–°é€‰é¡¹</a></li><li class="sidebar-sub-header"><a href="/pinia-doc-cn/core/plugins.html#typescript" class="sidebar-link">TypeScript</a></li><li class="sidebar-sub-header"><a href="/pinia-doc-cn/core/plugins.html#nuxt-js" class="sidebar-link">Nuxt.js</a></li></ul></li><li><a href="/pinia-doc-cn/core/outside-component-usage.html" class="sidebar-link">ç»„ä»¶å¤–ä½¿ç”¨Store</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/pinia-doc-cn/ssr/vue-and-vite" class="sidebar-heading clickable"><span>æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/pinia-doc-cn/ssr/vue-and-vite.html" class="sidebar-link">Vueå’ŒVite</a></li><li><a href="/pinia-doc-cn/ssr/nuxt.html" class="sidebar-link">Nuxt</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/pinia-doc-cn/cookbook/migration-vuex" class="sidebar-heading clickable"><span>æ“ä½œæ‰‹å†Œ</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/pinia-doc-cn/cookbook/migration-vuex.html" class="sidebar-link">ä»Vuexâ‰¤4è¿ç§»</a></li><li><a href="/pinia-doc-cn/cookbook/hot-module-replacement.html" class="sidebar-link">HMR(çƒ­æ¨¡å—æ›´æ–°)</a></li><li><a href="/pinia-doc-cn/cookbook/testing.html" class="sidebar-link">Testing(æµ‹è¯•)</a></li><li><a href="/pinia-doc-cn/cookbook/options-api.html" class="sidebar-link">ä¸ä½¿ç”¨setup()çš„ç”¨æ³•</a></li><li><a href="/pinia-doc-cn/cookbook/composing-stores.html" class="sidebar-link">ç»„åˆStores</a></li><li><a href="/pinia-doc-cn/cookbook/migration-v1-v2.html" class="sidebar-link">ä»0.x(v1)è¿ç§»åˆ°v2</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="plugins"><a href="#plugins" class="header-anchor">#</a> Plugins</h1> <p>ç”±äºä½ç‰ˆæœ¬çš„<code>API</code>ï¼Œ<code>Pinia</code>çš„<code>stores</code>å¯ä»¥å®Œå…¨æ‰©å±•ã€‚ä¸‹é¢æ˜¯ä¸€äº›ä½ å¯ä»¥åšçš„äº‹æƒ…:</p> <ul><li>å‘<code>stores</code>æ·»åŠ æ–°çš„å±æ€§</li> <li>åœ¨å®šä¹‰<code>stores</code>æ—¶æ·»åŠ æ–°é€‰é¡¹</li> <li>å‘<code>stores</code>æ·»åŠ æ–°æ–¹æ³•</li> <li>åŒ…è£…ç°æœ‰çš„æ–¹æ³•</li> <li>æ›´æ”¹ç”šè‡³å–æ¶ˆæ“ä½œ</li> <li>å®ç°åƒæœ¬åœ°å­˜å‚¨è¿™æ ·çš„åŠŸèƒ½</li> <li>åªé€‚ç”¨äºç‰¹å®šçš„<code>stores</code></li></ul> <p>ä½¿ç”¨<code>pinia.use()</code>å°†æ’ä»¶æ·»åŠ åˆ°<code>pinia</code>å®ä¾‹ä¸­ã€‚æœ€ç®€å•çš„ä¾‹å­æ˜¯é€šè¿‡è¿”å›ä¸€ä¸ªå¯¹è±¡å‘æ‰€æœ‰<code>stores</code> æ·»åŠ ä¸€ä¸ªé™æ€å±æ€§:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>

<span class="token comment">// add a property named `secret` to every store that is created after this plugin is installed</span>
<span class="token comment">// this could be in a different file</span>
<span class="token keyword">function</span> <span class="token function">SecretPiniaPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">secret</span><span class="token operator">:</span> <span class="token string">'the cake is a lie'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> pinia <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// give the plugin to pinia</span>
pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>SecretPiniaPlugin<span class="token punctuation">)</span>

<span class="token comment">// in another file</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
store<span class="token punctuation">.</span>secret <span class="token comment">// 'the cake is a lie'</span>
</code></pre></div><p>è¿™å¯¹äºæ·»åŠ å…¨å±€å¯¹è±¡ï¼ˆå¦‚<code>router</code>ã€<code>modal</code>æˆ–<code>toast</code>ç®¡ç†å™¨ï¼‰éå¸¸æœ‰ç”¨ã€‚</p> <h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="header-anchor">#</a> ä»‹ç»</h2> <p><code>Pinia</code>çš„æ’ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥é€‰æ‹©è¿”å›è¦æ·»åŠ åˆ°<code>store</code>ä¸­çš„å±æ€§ã€‚å®ƒæœ‰ä¸€ä¸ªå¯é€‰å‚æ•° <code>context</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">myPiniaPlugin</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  context<span class="token punctuation">.</span>pinia <span class="token comment">// the pinia created with `createPinia()`</span>
  context<span class="token punctuation">.</span>app <span class="token comment">// the current app created with `createApp()` (Vue 3 only)</span>
  context<span class="token punctuation">.</span>store <span class="token comment">// the store the plugin is augmenting</span>
  context<span class="token punctuation">.</span>options <span class="token comment">// the options object defining the store passed to `defineStore()`</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶åå°†æ­¤å‡½æ•°ä¼ é€’ç»™<code>pinia</code>çš„<code>pinia.use()</code>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>myPiniaPlugin<span class="token punctuation">)</span>
</code></pre></div><p>æ’ä»¶åªåº”ç”¨äº<code>stores</code>è¢«åˆ›å»ºåœ¨<code>pinia</code>ä¼ é€’ç»™åº”ç”¨ç¨‹åºå ï¼Œå¦åˆ™å®ƒä»¬ä¸ä¼šè¢«åº”ç”¨ã€‚</p> <h2 id="æ‰©å±•-store"><a href="#æ‰©å±•-store" class="header-anchor">#</a> æ‰©å±• Store</h2> <p>ä½ å¯ä»¥é€šè¿‡åœ¨æ’ä»¶ä¸­è¿”å›ä¸€ä¸ªå±æ€§å¯¹è±¡æ¥ä¸ºæ¯ä¸ª<code>store</code>æ·»åŠ å±æ€§:</p> <div class="language-js extra-class"><pre class="language-js"><code>pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">hello</span><span class="token operator">:</span> <span class="token string">'world'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨<code>store</code>ä¸­è®¾ç½®å±æ€§ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œè¯·è¿”å›ç‰ˆæœ¬ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥è¢«<code>devtools</code>è‡ªåŠ¨è·Ÿè¸ªï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span>hello <span class="token operator">=</span> <span class="token string">'world'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>æ’ä»¶è¿”å›çš„ä»»ä½•å±æ€§éƒ½å°†ç”±<code>devtools</code>è‡ªåŠ¨è¿½è¸ªï¼Œå› æ­¤ä¸ºäº†<code>hello</code>åœ¨<code>devtools</code>ä¸­å¯è§ï¼Œè¯·ç¡®ä¿ä»…åœ¨å¼€å‘æ¨¡å¼ä¸­æ·»åŠ <code>store._customProperties</code>å±æ€§ï¼Œå¦‚æœæ‚¨æƒ³åœ¨<code>devtools</code>ä¸­è°ƒè¯•çš„è¯ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// from the example above</span>
pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span>hello <span class="token operator">=</span> <span class="token string">'world'</span>
  <span class="token comment">// make sure your bundler handle this. webpack and vite should do it by default</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// add any keys you set on the store</span>
    store<span class="token punctuation">.</span>_customProperties<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯ä¸ª<code>store</code>éƒ½ä¼šä½¿ç”¨<a href="https://v3.vuejs.org/api/basic-reactivity.html#reactive" target="_blank" rel="noopener noreferrer"><code>reactive</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>åŒ…è£…ï¼Œå¹¶ä¸”ä¼šè‡ªåŠ¨è§£åŒ…å®ƒåŒ…å«çš„ä»»ä½•<code>Ref</code>(<code>ref()</code>, <code>computed()</code>, ...ï¼‰ç­‰ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> sharedRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'shared'</span><span class="token punctuation">)</span>
pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// each store has its individual `hello` property</span>
  store<span class="token punctuation">.</span>hello <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'secret'</span><span class="token punctuation">)</span>
  <span class="token comment">// it gets automatically unwrapped</span>
  store<span class="token punctuation">.</span>hello <span class="token comment">// 'secret'</span>

  <span class="token comment">// all stores are sharing the value `shared` property</span>
  store<span class="token punctuation">.</span>shared <span class="token operator">=</span> sharedRef
  store<span class="token punctuation">.</span>shared <span class="token comment">// 'shared'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‚¨å¯ä»¥è®¿é—®æ‰€æœ‰ä¸å¸¦<code>.value</code>è®¡ç®—å±æ€§å®ƒä»¬æ˜¯å“åº”å¼çš„åŸå› ã€‚</p> <h3 id="æ·»åŠ æ–°çŠ¶æ€"><a href="#æ·»åŠ æ–°çŠ¶æ€" class="header-anchor">#</a> æ·»åŠ æ–°çŠ¶æ€</h3> <p>å¦‚æœæ‚¨æƒ³åœ¨æ¿€æ´»è¿‡ç¨‹ä¸­æ·»åŠ æ–°çš„çŠ¶æ€å±æ€§æˆ–å±æ€§åˆ°<code>store</code>ï¼Œæ‚¨å¿…é¡»åœ¨ä¸¤ä¸ªåœ°æ–¹æ·»åŠ å®ƒï¼š</p> <ul><li>åœ¨<code>store</code>ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡<code>store.myState</code>è®¿é—®å®ƒ</li> <li>åœ¨<code>store.$state</code>ä¸­ï¼Œå®ƒå¯ä»¥åœ¨<code>devtools</code>ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨<code>SSR</code>æœŸé—´è¢«åºåˆ—åŒ–ã€‚</li></ul> <p>è¯·æ³¨æ„ï¼Œè¿™å…è®¸æ‚¨å…±äº«<code>ref</code>æˆ–<code>computed</code>å±æ€§ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> globalSecret <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'secret'</span><span class="token punctuation">)</span>
pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// `secret` is shared among all stores</span>
  store<span class="token punctuation">.</span>$state<span class="token punctuation">.</span>secret <span class="token operator">=</span> globalSecret
  store<span class="token punctuation">.</span>secret <span class="token operator">=</span> globalSecret
  <span class="token comment">// it gets automatically unwrapped</span>
  store<span class="token punctuation">.</span>secret <span class="token comment">// 'secret'</span>

  <span class="token keyword">const</span> hasError <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
  store<span class="token punctuation">.</span>$state<span class="token punctuation">.</span>hasError <span class="token operator">=</span> hasError
  <span class="token comment">// this one must always be set</span>
  store<span class="token punctuation">.</span>hasError <span class="token operator">=</span> <span class="token function">toRef</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>$state<span class="token punctuation">,</span> <span class="token string">'hasError'</span><span class="token punctuation">)</span>

  <span class="token comment">// in this case it's better not to return `hasError` since it</span>
  <span class="token comment">// will be displayed in the `state` section in the devtools</span>
  <span class="token comment">// anyway and if we return it, devtools will display it twice.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è¯·æ³¨æ„ï¼Œåœ¨æ’ä»¶ä¸­å‘ç”Ÿçš„çŠ¶æ€æ”¹å˜æˆ–æ·»åŠ ï¼ˆåŒ…æ‹¬è°ƒç”¨<code>store.$patch()</code>ï¼‰å‘ç”Ÿåœ¨<code>store</code>æ¿€æ´»ä¹‹å‰ï¼Œå› æ­¤ä¸ä¼šè§¦å‘ä»»ä½•è®¢é˜…ã€‚</p> <blockquote><p><strong>WARNING</strong>
å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯<code>Vue 2</code>ï¼Œ<code>Pinia</code>å°†å—åˆ°ä¸<code>Vue</code>ç›¸åŒçš„ååº”è­¦å‘Šã€‚å½“åˆ›å»ºæ–°çš„çŠ¶æ€å±æ€§å¦‚ <code>secret</code>å’Œ<code>hasError</code>æ—¶ï¼Œæ‚¨éœ€è¦ä½¿ç”¨æ¥è‡ª<code>@vue/composition-api</code>çš„<code>set</code>æ–¹æ³•ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> set <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/composition-api'</span>
pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>store<span class="token punctuation">.</span>$state<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> secretRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'secret'</span><span class="token punctuation">)</span>
    <span class="token comment">// If the data is meant to be used during SSR, you should</span>
    <span class="token comment">// set it on the `$state` property so it is serialized and</span>
    <span class="token comment">// picked up during hydration</span>
    <span class="token function">set</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>$state<span class="token punctuation">,</span> <span class="token string">'secret'</span><span class="token punctuation">,</span> secretRef<span class="token punctuation">)</span>
    <span class="token comment">// set it directly on the store too so you can access it</span>
    <span class="token comment">// both ways: `store.$state.secret` / `store.secret`</span>
    <span class="token function">set</span><span class="token punctuation">(</span>store<span class="token punctuation">,</span> <span class="token string">'secret'</span><span class="token punctuation">,</span> secretRef<span class="token punctuation">)</span>
    store<span class="token punctuation">.</span>secret <span class="token comment">// 'secret'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="æ·»åŠ æ–°çš„å¤–éƒ¨å±æ€§"><a href="#æ·»åŠ æ–°çš„å¤–éƒ¨å±æ€§" class="header-anchor">#</a> æ·»åŠ æ–°çš„å¤–éƒ¨å±æ€§</h2> <p>å½“æ·»åŠ å¤–éƒ¨å±æ€§ï¼Œæ¥è‡ªå…¶ä»–åº“çš„ç±»å®ä¾‹æˆ–ç®€å•çš„éå“åº”å¼å¯¹è±¡æ—¶ï¼Œåº”è¯¥åœ¨å°†å¯¹è±¡ä¼ é€’ç»™<code>pinia</code> ä¹‹å‰ä½¿ç”¨<code>markRaw()</code>åŒ…è£…è¯¥å¯¹è±¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°†è·¯ç”±æ·»åŠ åˆ°æ‰€æœ‰<code>store</code>çš„ç¤ºä¾‹:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> markRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token comment">// adapt this based on where your router is</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> router <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./router'</span>

pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span>router <span class="token operator">=</span> <span class="token function">markRaw</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="åœ¨æ’ä»¶å†…éƒ¨è°ƒç”¨-subscribe"><a href="#åœ¨æ’ä»¶å†…éƒ¨è°ƒç”¨-subscribe" class="header-anchor">#</a> åœ¨æ’ä»¶å†…éƒ¨è°ƒç”¨ $subscribe</h2> <p>æ‚¨ä¹Ÿå¯ä»¥åœ¨æ’ä»¶ä¸­ä½¿ç”¨<a href="https://baimingxuan.net/pinia-doc-cn/core/state.html#%E8%AE%A2%E9%98%85-state" target="_blank" rel="noopener noreferrer">store.$subscribe<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>å’Œ<a href="https://baimingxuan.net/pinia-doc-cn/core/actions.html#%E8%AE%A2%E9%98%85-actions" target="_blank" rel="noopener noreferrer">store.$onAction<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-ts extra-class"><pre class="language-ts"><code>pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> store <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span><span class="token function">$subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// react to store changes</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  store<span class="token punctuation">.</span><span class="token function">$onAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// react to store actions</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="æ·»åŠ æ–°é€‰é¡¹"><a href="#æ·»åŠ æ–°é€‰é¡¹" class="header-anchor">#</a> æ·»åŠ æ–°é€‰é¡¹</h2> <p>å¯ä»¥åœ¨å®šä¹‰<code>stores</code>æ—¶åˆ›å»ºæ–°çš„é€‰é¡¹ï¼Œä»¥ä¾¿éšåä»æ’ä»¶ä¸­ä½¿ç”¨å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª<code>debounce</code>é€‰é¡¹ï¼Œå…è®¸ä½ å¯¹ä»»ä½•æ“ä½œè¿›è¡Œ<code>debounce</code> :</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">'search'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">searchContacts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// this will be read by a plugin later on</span>
  <span class="token literal-property property">debounce</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// debounce the action searchContacts by 300ms</span>
    <span class="token literal-property property">searchContacts</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>æ’ä»¶å¯ä»¥è¯»å–è¯¥é€‰é¡¹æ¥åŒ…è£…<code>actions</code>å¹¶æ›¿æ¢åŸæ¥çš„<code>actions</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// use any debounce library</span>
<span class="token keyword">import</span> debounce <span class="token keyword">from</span> <span class="token string">'lodash/debunce'</span>

pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> options<span class="token punctuation">,</span> store <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>debounce<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// we are overriding the actions with new ones</span>
    <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>debounce<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">debouncedActions<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      debouncedActions<span class="token punctuation">[</span>action<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">debounce</span><span class="token punctuation">(</span>
        store<span class="token punctuation">[</span>action<span class="token punctuation">]</span><span class="token punctuation">,</span>
        options<span class="token punctuation">.</span>debounce<span class="token punctuation">[</span>action<span class="token punctuation">]</span>
      <span class="token punctuation">)</span>
      <span class="token keyword">return</span> debouncedActions
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è¯·æ³¨æ„ï¼Œä½¿ç”¨<code>setup</code>è¯­æ³•æ—¶ï¼Œè‡ªå®šä¹‰é€‰é¡¹ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">defineStore</span><span class="token punctuation">(</span>
  <span class="token string">'search'</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// this will be read by a plugin later on</span>
    <span class="token literal-property property">debounce</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// debounce the action searchContacts by 300ms</span>
      <span class="token literal-property property">searchContacts</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="typescript"><a href="#typescript" class="header-anchor">#</a> TypeScript</h2> <p>ä¸Šé¢æ˜¾ç¤ºçš„æ‰€æœ‰å†…å®¹éƒ½å¯ä»¥é€šè¿‡ç¼–å†™æ”¯æŒï¼Œå› æ­¤æ‚¨æ— éœ€ä½¿ç”¨<code>any</code>æˆ–<code>@ts-ignore</code>ã€‚</p> <h3 id="ç¼–å†™æ’ä»¶"><a href="#ç¼–å†™æ’ä»¶" class="header-anchor">#</a> ç¼–å†™æ’ä»¶</h3> <p><code>Pinia</code>æ’ä»¶å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼ç¼–å†™ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> PiniaPluginContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">myPiniaPlugin</span><span class="token punctuation">(</span>context<span class="token operator">:</span> PiniaPluginContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ç¼–å†™æ–°çš„storeå±æ€§"><a href="#ç¼–å†™æ–°çš„storeå±æ€§" class="header-anchor">#</a> ç¼–å†™æ–°çš„storeå±æ€§</h3> <p>å½“å‘<code>stores</code>æ·»åŠ æ–°å±æ€§æ—¶ï¼Œæ‚¨è¿˜åº”è¯¥æ‰©å±•<code>PiniaCustomProperties</code>æ¥å£ã€‚</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token string">'pinia'</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'pinia'</span> <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">PiniaCustomProperties</span> <span class="token punctuation">{</span>
    <span class="token comment">// by using a setter we can allow both strings and refs</span>
    <span class="token keyword">set</span> <span class="token function">hello</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> Ref<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
    <span class="token keyword">get</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span>

    <span class="token comment">// you can define simpler values too</span>
    simpleNumber<span class="token operator">:</span> <span class="token builtin">number</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶åå¯ä»¥å®‰å…¨åœ°å†™å…¥å’Œè¯»å–ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code>pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> store <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span>hello <span class="token operator">=</span> <span class="token string">'Hola'</span>
  store<span class="token punctuation">.</span>hello <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'Hola'</span><span class="token punctuation">)</span>

  store<span class="token punctuation">.</span><span class="token builtin">number</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// @ts-expect-error: we haven't typed this correctly</span>
  store<span class="token punctuation">.</span><span class="token builtin">number</span> <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><code>PiniaCustomProperties</code>æ˜¯ä¸€ä¸ªæ³›å‹ç±»å‹ï¼Œå…è®¸æ‚¨å¼•ç”¨<code>store</code>çš„å±æ€§ã€‚æƒ³è±¡ä¸€ä¸‹ä¸‹é¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å°†åˆå§‹é€‰é¡¹å¤åˆ¶ä¸º<code>$options</code>ï¼ˆè¿™ä»…é€‚ç”¨äº<code>option stores</code>ï¼‰ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code>pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> $options<span class="token operator">:</span> options <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨<code>PiniaCustomProperties</code>çš„4ä¸ªæ³›å‹ç±»å‹æ¥æ­£ç¡®åœ°è¾“å…¥è¿™ä¸ªå€¼:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token string">'pinia'</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'pinia'</span> <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">PiniaCustomProperties<span class="token operator">&lt;</span>Id<span class="token punctuation">,</span> <span class="token constant">S</span><span class="token punctuation">,</span> <span class="token constant">G</span><span class="token punctuation">,</span> <span class="token constant">A</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    $options<span class="token operator">:</span> <span class="token punctuation">{</span>
      id<span class="token operator">:</span> Id
      state<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">S</span>
      getters<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">G</span>
      actions<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">A</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>TIP</p> <p>åœ¨æ³›å‹ä¸­æ‰©å±•ç±»å‹æ—¶ï¼Œå®ƒä»¬çš„å‘½åå¿…é¡»ä¸æºç ä¸­çš„å®Œå…¨ç›¸åŒã€‚<code>Id</code>ä¸èƒ½å‘½åä¸º<code>id</code>æˆ–<code>I</code>ï¼Œ<code>S</code>ä¹Ÿä¸èƒ½å‘½åä¸º<code>State</code>ã€‚ä»¥ä¸‹æ˜¯æ¯ä¸ªå­—æ¯æ‰€ä»£è¡¨çš„å«ä¹‰ï¼š</p> <ul><li>S: State</li> <li>G: Getters</li> <li>A: Actions</li> <li>SS: Setup Store / Store</li></ul></blockquote> <h3 id="ç¼–å†™æ–°çš„çŠ¶æ€"><a href="#ç¼–å†™æ–°çš„çŠ¶æ€" class="header-anchor">#</a> ç¼–å†™æ–°çš„çŠ¶æ€</h3> <p>å½“æ·»åŠ æ–°çš„çŠ¶æ€å±æ€§æ—¶(åŒæ—¶æ·»åŠ åˆ°<code>store</code>å’Œ<code>store.$state</code>)ï¼Œæ‚¨éœ€è¦å°†ç±»å‹æ·»åŠ åˆ°<code>PiniaCustomStateProperties</code>ã€‚ä¸<code>PiniaCustomProperties</code>ä¸åŒçš„æ˜¯ï¼Œå®ƒåªæ¥æ”¶<code>State</code>æ³›å‹ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token string">'pinia'</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'pinia'</span> <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">PiniaCustomStateProperties<span class="token operator">&lt;</span><span class="token constant">S</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    hello<span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ç¼–å†™æ–°çš„åˆ›å»ºé€‰é¡¹"><a href="#ç¼–å†™æ–°çš„åˆ›å»ºé€‰é¡¹" class="header-anchor">#</a> ç¼–å†™æ–°çš„åˆ›å»ºé€‰é¡¹</h3> <p>å½“ä¸º<code>defineStore()</code>åˆ›å»ºæ–°é€‰é¡¹æ—¶ï¼Œæ‚¨åº”è¯¥æ‰©å±•<code>DefineStoreOptionsBase</code>ã€‚ä¸<code>PiniaCustomProperties</code>ä¸åŒçš„æ˜¯ï¼Œå®ƒåªå…¬å¼€ä¸¤ç§æ³›å‹ï¼š<code>State</code>å’Œ<code>Store</code>ç±»å‹ï¼Œå…è®¸æ‚¨é™åˆ¶å¯ä»¥å®šä¹‰çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>actions</code>çš„åç§°:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token string">'pinia'</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'pinia'</span> <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">DefineStoreOptionsBase<span class="token operator">&lt;</span><span class="token constant">S</span><span class="token punctuation">,</span> Store<span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token comment">// allow defining a number of ms for any of the actions</span>
    debounce<span class="token operator">?</span><span class="token operator">:</span> Partial<span class="token operator">&lt;</span>Record<span class="token operator">&lt;</span><span class="token keyword">keyof</span> StoreActions<span class="token operator">&lt;</span>Store<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">&gt;&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>TIP
è¿˜æœ‰ä¸€ä¸ª<code>StoreGetters</code>ç±»å‹ç”¨äºä»<code>Store</code>ç±»å‹ä¸­æå–<code>getters</code>ã€‚æ‚¨è¿˜å¯ä»¥åˆ†åˆ«é€šè¿‡<code>DefineStoreOptions</code>å’Œ<code>DefineSetupStoreOptions</code>ç±»å‹æ¥æ‰©å±•è®¾ç½®<code>setup stores</code>æˆ–<code>option stores</code>çš„é€‰é¡¹ã€‚</p></blockquote> <h2 id="nuxt-js"><a href="#nuxt-js" class="header-anchor">#</a> Nuxt.js</h2> <p>å½“<code>Nuxt</code>å’Œ<code>Pinia</code>ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæ‚¨å¿…é¡»å…ˆåˆ›å»ºä¸€ä¸ª<a href="https://nuxtjs.org/docs/2.x/directory-structure/plugins" target="_blank" rel="noopener noreferrer"><code>Nuxt</code>æ’ä»¶<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚è¿™å°†ä½¿æ‚¨å¯ä»¥è®¿é—®è¯¥<code>Pinia</code>å®ä¾‹ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// plugins/myPiniaPlugin.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PiniaPluginContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nuxt/types'</span>

<span class="token keyword">function</span> <span class="token function">MyPiniaPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span> store <span class="token punctuation">}</span><span class="token operator">:</span> PiniaPluginContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  store<span class="token punctuation">.</span><span class="token function">$subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mutation<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// react to store changes</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[ğŸ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mutation<span class="token punctuation">.</span>storeId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mutation<span class="token punctuation">.</span><span class="token keyword">type</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> creationTime<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> myPlugin<span class="token operator">:</span> Plugin <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> pinia <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  pinia<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>MyPiniaPlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> myPlugin
</code></pre></div><p>æ³¨æ„ä¸Šé¢çš„ä¾‹å­ä½¿ç”¨çš„æ˜¯<code>TypeScript</code>ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯<code>.js</code>æ–‡ä»¶ï¼Œä½ å¿…é¡»åˆ é™¤<code>PiniaPluginContext</code>çš„ç±»å‹æ³¨é‡Šå’Œ<code>Plugin</code>çš„å¼•å…¥ã€‚</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/baimingxuan/pinia-doc-cn/edit/main/docs/core/plugins.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°æ—¶é—´:</span> <span class="time">2022/3/24 ä¸‹åˆ10:47:41</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/pinia-doc-cn/core/actions.html" class="prev">
        Actions
      </a></span> <span class="next"><a href="/pinia-doc-cn/core/outside-component-usage.html">
        ç»„ä»¶å¤–ä½¿ç”¨Store
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/pinia-doc-cn/assets/js/app.26e1221b.js" defer></script><script src="/pinia-doc-cn/assets/js/2.cc001fb0.js" defer></script><script src="/pinia-doc-cn/assets/js/18.6ca16828.js" defer></script>
  </body>
</html>
